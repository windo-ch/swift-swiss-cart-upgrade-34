import React, { useState } from "react";
import { useNavigate } from "react-router-dom";
import { toast } from "sonner";
import { deliveryData } from "@/utils/zurichMapData";
import MapContainer from "./map/MapContainer";
import DistrictPath from "./map/DistrictPath";
import DistrictTooltip from "./map/DistrictTooltip";

interface ZurichMapProps {
  onSelectDistrict?: (district: string) => void;
  onHoverDistrict?: (district: string | null) => void;
  interactive?: boolean;
}

const ZurichMap: React.FC<ZurichMapProps> = ({
  onSelectDistrict,
  onHoverDistrict,
  interactive = true,
}) => {
  const [hoveredDistrict, setHoveredDistrict] = useState<string | null>(null);
  const navigate = useNavigate();
  
  const handleHoverDistrict = (district: string | null) => {
    setHoveredDistrict(district);
    if (onHoverDistrict) {
      onHoverDistrict(district);
    }
  };

  const handleDistrictClick = (district: string) => {
    if (!interactive) return;
    if (onSelectDistrict) {
      onSelectDistrict(district);
    } else {
      toast.success(`${district.replace("kreis", "Kreis ")} ausgew√§hlt`, {
        description: `Lieferung in ${deliveryData[district]?.time || "30-60"} Minuten`,
      });
      navigate(`/order?district=${district}`);
    }
  };

  return (
    <MapContainer>
      <DistrictPath
        district="kreis1"
        path="M539.83 499.54c.99-6.59 13.87-21.15 13.91-27.32-1.77-4.76-10.39-38.13-12.15-39.32-3.14-2.12-18.55 4.03-21.4 2.22-.87-.55-1.94-7.1-5.04-8.51-4.42-2.02-16.58-.69-20.34-3.03-2.07-1.29-5.18-11.02-7.5-12.2-1.82-.92-8.88 2.99-11.19 3.82-10.28 20.98-20.45 42.11-30.11 63.38-1.49 3.29-9.43 19.75-9.22 21.64.05.49 2.74 4.89 2.99 5.04 1.96 1.14 18.75-9.18 21.83-10.99 1.69 0 5.44 8.67 6.19 9.19.81.56 3.69-2.45 6.48.49 4.06 4.28 13.79 27.5 16.76 29.09 1.39.75 1.4.1 2.36-.5 3.3-2.08 12.63-12.06 16.41-9.87 1.77 1.03 9.59 19.19 10.71 19.2l18.98-17.49c.79-1.41 3.12-14.74 3.04-16.64-.14-3.19-3.11-5.52-2.71-8.21Z"
        onMouseEnter={() => handleHoverDistrict('kreis1')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis1')}
      />
      <DistrictPath
        district="kreis2"
        path="M509.81 762c-4.09-6.09-15.21-12.92-19.14-19.21-2.53-4.05-15.87-33.11-16.94-37.29-1.14-4.42.05-9.15-.45-13.57-.36-3.19-3.25-22.61-4.16-23.89-1.29-1.84-7.5-.52-9.86-.9l8.34-36.07c-1.02-10.93.56-22.47 1.05-33.54.74-16.8-1.96-41.25 8.35-55.23 3.09-4.19 10.92-4.24 8.64-9.53-.82-1.9-12.8-21.79-13.74-22.72-1.5-1.49-4.05-.56-6.08-1.4-2.01-.84-3.46-4.68-3.93-4.95-3.67-2.15-20.62 10.77-25.05 8.72-1.96-.91-3.26-5.26-6.45-4.09l-20.5 25.77-.2 4.47 9.34 86.46c-12.04 6.73-26.31 13.18-37.67 20.81-1.95 1.31-3.12 1.75-4.6 3.81-1.19 1.67-6.43 12.55-6.33 14.16.29 4.5 14.42 24.05 12.69 26.73-1.69 2.62-18.53 8.85-21.83 11.96-15.27-2.55-26.82-.69-39.43 8.19-1.77 1.25-15.76 13.69-16.25 14.68-2.98 5.99-4.87 19.21-7.14 26.45-.83 2.65-2.79 4.26-3.56 6.73-2.22 7.11.1 15.65-1.36 22.02-.82 3.6-6.12 6.55-6.4 10.43 1.03 19.32-.18 39.82.95 58.99.67 11.35 3.52 18.48 8.47 28.48 1.26.95 17.2-11.07 19.91-12.33 31.27-14.6 57.01-10.65 89.98-12.87 1.16-.08 7.42-.91 7.75-1.13 1.11-.74 2.68-10.9 4.52-12.08 4.54-2.91 19.59-3.74 25.33-6.7 2.73-3.46 14.55-26.59 16.32-27.62 2.72-1.58 18.81 1.22 21.38-.6l3.25-12.65 25.58-27.8c.43-1.16-.2-1.79-.78-2.66Z"
        onMouseEnter={() => handleHoverDistrict('kreis2')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis2')}
      />
      <DistrictPath
        district="kreis3"
        path="M128.27,196.87c-2.34-.53-13.73-2.53-14.55-3.68-1.69-2.38,1.37-8.3.52-11.28-2.42-.7-9.62,2.88-11.13,1.79-.49-.36-3.87-10.42-3.8-11.55.24-3.73,6.69-10.29,7.29-14.31.74-4.93-7.96-9.22-2.87-17.76,3-5.03,11.28-2.04,16.15-3.48,1.03-.31,15.36-10.4,15.93-11.19,2.52-3.54,2.8-26,4.54-27.25,6.52-.79,13.27,2.65,19.97,2.44,1.33-.33,5.8-10.7,6.42-11.1,1.28-.8,8.9-.06,10.46.92,2.84,1.79,1.17,7.75,3.42,9.67,1.78,1.53,15.06,3.07,18.96,4.42,7.74,2.66,15.96,8.62,23.58,11.95l56.85,54.87c9.57,2.28,19.54,2.7,29.1,5.03s30.17,12.37,37.62,12.75c4.19.22,12.67-5.37,17.37-4.22l35.98,25.32,4.1,12.74c4.11.75,16.85-5.29,19.61-3.26l16.11,83.94c4.22,5.4,6.51,15.37,10.5,20.35,2.17,2.7,12.43,7.87,12.66,9.82,0,9.03.06,17.98-1,26.94-2.44,1.41-10.43,8.59-12.45,8.05l-41.46-33.43c-13.2-6.56-30.9-9.61-43.7-16.14-4.46-2.28-8.38-8.67-11.75-9.76-15.57-5.01-39.02-2.73-55.72-7.86-12.52-3.84-10.13-10.59-17.88-15.78-8.77-5.87-23.5-9.01-32.78-14.93l-32.33,3.57-26.51-29.8c-8.22-2.09-18.89-9.9-26.49-11.85s-14.15,3.78-14.14-8.39c0-4.61,3.1-13.9,1.8-17.61-1.1-3.14-8.59-2.3-9.25-7.57-.19-1.53.34-9.17,1.08-9.77,1.25-1.03,6.89,2.04,6.45-3.83l-18.7-2.81v14.02Z"
        onMouseEnter={() => handleHoverDistrict('kreis3')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis3')}
      />
      <DistrictPath
        district="kreis4"
        path="M461.9,503.7c.47.28,1.92,4.11,3.93,4.95s4.57-.09,6.08,1.4c.94.94,12.92,20.82,13.74,22.72,2.28,5.28-5.55,5.34-8.64,9.53-10.31,13.97-7.61,38.42-8.35,55.23-.49,11.07-2.06,22.61-1.05,33.54l-8.34,36.07c2.36.38,8.57-.94,9.86.9.9,1.28,3.79,20.7,4.16,23.89.5,4.42-.68,9.15.45,13.57,1.07,4.18,14.41,33.24,16.94,37.29,3.93,6.29,15.05,13.11,19.14,19.21.58.87,1.21,1.5.78,2.66l-25.58,27.8-3.25,12.65c-2.57,1.82-18.66-.97-21.38.6-1.77,1.03-13.59,24.16-16.32,27.62-5.73,2.96-20.79,3.79-25.33,6.7-1.84,1.18-3.41,11.34-4.52,12.08-.33.22-6.59,1.05-7.75,1.13-32.97,2.22-58.71-1.73-89.98,12.87-2.71,1.26-18.65,13.29-19.91,12.33-4.95-10-7.8-17.13-8.47-28.48-1.13-19.17.08-39.67-.95-58.99.28-3.87,5.58-6.82,6.4-10.43,1.45-6.36-.87-14.91,1.36-22.02.77-2.46,2.73-4.08,3.56-6.73,2.27-7.23,4.16-20.46,7.14-26.45.49-.98,14.48-13.42,16.25-14.68,12.61-8.88,24.16-10.73,39.43-8.19,3.3-3.11,20.14-9.33,21.83-11.96s-12.4-22.23-12.69-26.73c-.1-1.61,5.14-12.49,6.33-14.16,1.48-2.07,2.65-2.51,4.6-3.81,11.35-7.63,25.63-14.08,37.67-20.81l-9.34-86.46.2-4.47,20.5-25.77c3.19-1.17,4.49,3.18,6.45,4.09,4.43,2.05,21.37-10.87,25.05-8.72Z"
        onMouseEnter={() => handleHoverDistrict('kreis4')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis4')}
      />
      <DistrictPath
        district="kreis5"
        path="M385.08,465.52l34.03,41.33-.93,2.81c-2.94,3.64-19.92,19.44-20.19,22.34l9.67,87.73c-.72,1.82-2.34,2.64-3.84,3.65-11.42,7.7-28.57,12.38-39.75,21.03-.74,1.27-4.71,18.11-4.59,19.34.49,4.75,8.09,16.4,9.42,22.32.3,1.35.61,3.25-.57,4.22-.29.24-6.52,2.72-6.89,2.76-5.76.62-14.57-1.81-21.18-.45-1.91.39-18.99,7.9-20.79,9.13-2,1.36-19.51,18.93-20.49,20.65-3.78,6.61-3.61,19.6-6.86,26.8-.57,1.26-.09,1.48-2.07,1.17-4.25-11.03-17.03-22.21-21.29-32.49-3.19-7.7-2.43-18.13-5.99-25.8l-46.62-50.62c-6.12-13.96-13.58-27.47-18.55-41.87l20.38-33.91c10.78-6.88,23.54-10.34,34.18-17.24l.58-41.95,19.09-4.76c2.65-5.54,18.04-21.59,18.97-25.98.27-1.26-.13-1.73-.55-2.76-3.41-8.33-12.9-18.39-16.34-26.74-.38-.93-.96-1.72-.59-2.8l24.38-26.62,3.28.51,84.09,48.21Z"
        onMouseEnter={() => handleHoverDistrict('kreis5')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis5')}
      />
      <DistrictPath
        district="kreis6"
        path="M660.29,174.42c7.07,1.07,15.14,4.75,22.08,5.52,9.4,1.04,20.4.21,29.81,1.05,12.82,1.15,25.23,14.68,37.37,18.73s27.4,4.64,39.78,8.38l-24.32,34.1,18.55,26.44c.34.78.14,1.52.02,2.31-.2,1.29-6.63,18-7.27,18.78-1.93,2.33-27.92,3.17-32.79,4.38.67,2.23,5.84,6.08,4.55,8.29-.09.15-1.93.73-2.69,1.47-7.1,6.87-23.79,18.98-28.44,25.82-3.21,4.73-8.15,24.52-9.89,26.11-1.47,1.34-1.69-.62-2.12-1.18-6.99-8.86-12.59-19.92-19.86-28.74-1.33-.32-11.68,9.81-14.2,11.02s-15.12,3.55-17.1,2.57l-68.7-71.63-19.19,1.96c-1.25-1.23,3.18-23.06,4.48-25.91,2.99-6.56,18.33-20.52,19.64-26.17-.59-21.12-1.78-42.15-1.55-63.26.95-2.77,27.55-9.27,31.66-12.28l7.43-28.12c1.25-.91,23.43,3.45,24.79,5.26,3.19,12.78,10.28,26.48,9.85,39.69-.15,4.63-1.22,10.72-1.86,15.42Z"
        onMouseEnter={() => handleHoverDistrict('kreis6')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis6')}
      />
      <DistrictPath
        district="kreis7"
        path="M466.43,226.17l41.4,47.81,52.43-6.07-.94,7.47c9.07.2,17.9-3.3,26.92-2.59l45.91,51.87-26.23,32.87c-2.74,1.6-11.07-6.9-15.07-6.27s-16.26,11.49-21.32,13.34l-2.33,7.95-29.29,27.78c-.33,1.94,10.26,13.97,10.99,16.92,1.35,5.47-17.76,10.27-20.71,9.46-3.28-.9-5.06-10.27-7.2-11.57-3.02-1.84-14.26,1.08-17.53-1.63-1.93-1.6-6.61-15.91-8.61-17.09-1.23-.73-10.5,3.42-12.12,2.3-.75-.52-.98-6.56-2.07-8.69-1.53-3-12.35-12.29-12.88-14.33.62-4.63,7.57-9.39,8.27-13.9.55-3.52-.87-6.1-.93-9.25-.15-7.73.19-15.49.05-23.22l-16.83-12.61-28.9-106.25c-1-1.47-8.54.53-10.41-1.96l4.74-8.82,2.09.14,40.56,26.32Z"
        onMouseEnter={() => handleHoverDistrict('kreis7')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis7')}
      />
      <DistrictPath
        district="kreis8"
        path="M614.7,574.37l46.14,8.56c10.4,6.23,24.77,27.11,34.48,31.9,9.09,4.49,27.51,4.62,38.09,7.74,1.03.3,3.33.32,2.62,2.02l-36.2,36.73-72.98,17.77c-1.09.29-2.17.37-3.27.05-2.48-.71-11.27-10.86-14.57-12.6l-17.95-30.67c-6.33-3.21-39.31-6.72-42.5-9.86-1.36-1.33-2.38-8.44-3.68-11.28-3.46-7.52-13.4-17.12-15.78-24.43-3.37-10.37-3.01-24.24-6.28-34.95l.93-2.8,23.99-25.59,22.51,10.04c2.94-.81,6.87-4.85,9.91-4.36,1.56.25,19.88,11.73,21.26,13.4,3.57,4.3,11.82,27.27,13.29,28.32Z"
        onMouseEnter={() => handleHoverDistrict('kreis8')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis8')}
      />
      <DistrictPath
        district="kreis9"
        path="M425.59,502.59c-.17.14-2.02.37-1.93-.59l-38.32-44.69-82.28-45.83-.83-1.09,12.09-13.92c-.02-1.68-15.87-7.05-17.34-9.8s8.58-8.21,7.07-10.29c-10.75-4.41-24.53-6.51-25.24-20.57l184.72,71.97-37.95,74.8Z"
        onMouseEnter={() => handleHoverDistrict('kreis9')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis9')}
      />
      <DistrictPath
        district="kreis10"
        path="M303.12,310.93c2.01.06,4.05-.15,6.07,0,8.89.68,31.87,2.3,39.23,4.72,5.15,1.69,11.4,8.53,17.65,11.33,11.39,5.1,25.04,7.7,36.5,13.06l67.65,53.42c4.7,6.01-.35,21.92-3.68,28.04-.66,1.21-1.25,2.47-2.88,2.37l-181.38-70.14-1.58-1.26c-.82-3.53,22.42-22.16,22.42-25.19v-16.36Z"
        onMouseEnter={() => handleHoverDistrict('kreis10')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis10')}
      />
      <DistrictPath
        district="kreis11"
        path="M520.18,435.13c2.86,1.81,18.26-4.34,21.4-2.22,1.77,1.19,10.38,34.56,12.15,39.32-.04,6.17-12.92,20.73-13.91,27.32-.4,2.68,2.57,5.01,2.71,8.21.08,1.9-2.25,15.22-3.04,16.64l-18.98,17.49c-1.12-.01-8.94-18.17-10.71-19.2-3.77-2.19-13.1,7.8-16.41,9.87-.96.6-.97,1.24-2.36.5-2.97-1.59-12.7-24.81-16.76-29.09-2.79-2.94-5.67.07-6.48-.49-.75-.52-4.5-9.19-6.19-9.19-3.07,1.8-19.87,12.13-21.83,10.99-.25-.15-2.94-4.54-2.99-5.04-.21-1.89,7.73-18.34,9.22-21.64,9.66-21.27,19.83-42.4,30.11-63.38,2.31-.83,9.37-4.74,11.19-3.82,2.32,1.17,5.43,10.91,7.5,12.2,3.76,2.35,15.92,1.02,20.34,3.03,3.1,1.41,4.17,7.96,5.04,8.51Z"
        onMouseEnter={() => handleHoverDistrict('kreis11')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis11')}
      />
      <DistrictPath
        district="kreis12"
        path="M379.17,350.19v2.94s-5.74.17-5.74.17l-1.15,2.77c13.21-1.16,9.41,14.26-2.95,10.81v-3.92c2.76.46,4.92,1.13,6.85-1.48-2.01-2.46-4.08-2.46-6.85-1.48v-9.83s9.83,0,9.83,0Z"
        onMouseEnter={() => handleHoverDistrict('kreis12')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis12')}
      />
      {hoveredDistrict && <DistrictTooltip district={hoveredDistrict} />}
    </MapContainer>
  );
};

export default ZurichMap;
