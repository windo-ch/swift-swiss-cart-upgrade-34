import React, { useState } from "react";
import { useNavigate } from "react-router-dom";
import { toast } from "sonner";
import { deliveryData } from "@/utils/zurichMapData";
import MapContainer from "./map/MapContainer";
import DistrictPath from "./map/DistrictPath";
import DistrictTooltip from "./map/DistrictTooltip";

interface ZurichMapProps {
  onSelectDistrict?: (district: string) => void;
  onHoverDistrict?: (district: string | null) => void;
  interactive?: boolean;
}

const ZurichMap: React.FC<ZurichMapProps> = ({
  onSelectDistrict,
  onHoverDistrict,
  interactive = true,
}) => {
  const [hoveredDistrict, setHoveredDistrict] = useState<string | null>(null);
  const navigate = useNavigate();
  
  const handleHoverDistrict = (district: string | null) => {
    setHoveredDistrict(district);
    if (onHoverDistrict) {
      onHoverDistrict(district);
    }
  };

  const handleDistrictClick = (district: string) => {
    if (!interactive) return;
    if (onSelectDistrict) {
      onSelectDistrict(district);
    } else {
      toast.success(`${district.replace("kreis", "Kreis ")} ausgew√§hlt`, {
        description: `Lieferung in ${deliveryData[district]?.time || "30-60"} Minuten`,
      });
      navigate(`/order?district=${district}`);
    }
  };

  return (
    <MapContainer>
      <DistrictPath
        district="kreis1"
        path="M682.71,340.86l26.67,32.71,14.97-36.45,12.7,17.2c4.79,4.55,22.34,11.14,25.24,14.98.65.87,1.03,1.63.83,2.75l-6.27,27.1c9.78,13.4,18.01,28.89,27.97,42.04,15.77,20.83,37.82,40.01,55.06,59.94,16.52,4.44,33.45,5.06,50.34,6.23.16,2.33.9,4.56,1.05,6.9.53,8.12,1.83,23.45.92,30.91-.53,4.32-4.09,8.57-5.63,12.59l38.34,7.01c1.35,1.39,8.73,33.85,9.16,37.68.58,5.14-10.61,8.97-15.09,10.65-16.66,6.24-35.33-3.06-52.37-2.61-11.43.3-25.55,5.48-37.31,6.2-2.77,1.24-6.65,21.31-10.08,22.94-.69.33-1.32.51-2.08.27-37.95-11.43-75.25-25.04-114.53-31.42l-36.73-35.26c-12.74-2.39-27.06-1.45-39.67-3.34-1.26-.19-2.28-.62-3.31-1.37-4.29-3.13-11.36-23.24-15.49-28.45l-24.08-15.23c-4.98-2.44-8.5,6.09-13.19,5.85-1.17-.06-19.61-9.8-20.29-10.72-.97-1.31,1.53-12.06,1.51-15.01,0-.79-1.53-1.67-1.29-3.49.66-4.94,14.85-24.88,14.66-28.12l-15.74-42.33c-.26-4.34,10.13-9.08,9.23-12.77-.8-3.31-9.82-11.84-11.56-15.68-.46-1.02-.88-1.79-.03-2.8l26.74-24.7c1.49-2.48.2-4.57,2.2-7.15.77-.99,14.3-9.88,15.27-10.07,3.49-.7,17.18,13.08,19.87,11.63l24.41-34.09c2.92-1.71,17.73,13.57,22.79,13.99,2.43.2,19.02-3.44,20.61-4.72s1.69-4.28,4.16-3.76Z"
        onMouseEnter={() => handleHoverDistrict('kreis1')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis1')}
      />
      <DistrictPath
        district="kreis2"
        path="M682.71,340.86l26.67,32.71,14.97-36.45,12.7,17.2c4.79,4.55,22.34,11.14,25.24,14.98.65.87,1.03,1.63.83,2.75l-6.27,27.1c9.78,13.4,18.01,28.89,27.97,42.04,15.77,20.83,37.82,40.01,55.06,59.94,16.52,4.44,33.45,5.06,50.34,6.23.16,2.33.9,4.56,1.05,6.9.53,8.12,1.83,23.45.92,30.91-.53,4.32-4.09,8.57-5.63,12.59l38.34,7.01c1.35,1.39,8.73,33.85,9.16,37.68.58,5.14-10.61,8.97-15.09,10.65-16.66,6.24-35.33-3.06-52.37-2.61-11.43.3-25.55,5.48-37.31,6.2-2.77,1.24-6.65,21.31-10.08,22.94-.69.33-1.32.51-2.08.27-37.95-11.43-75.25-25.04-114.53-31.42l-36.73-35.26c-12.74-2.39-27.06-1.45-39.67-3.34-1.26-.19-2.28-.62-3.31-1.37-4.29-3.13-11.36-23.24-15.49-28.45l-24.08-15.23c-4.98-2.44-8.5,6.09-13.19,5.85-1.17-.06-19.61-9.8-20.29-10.72-.97-1.31,1.53-12.06,1.51-15.01,0-.79-1.53-1.67-1.29-3.49.66-4.94,14.85-24.88,14.66-28.12l-15.74-42.33c-.26-4.34,10.13-9.08,9.23-12.77-.8-3.31-9.82-11.84-11.56-15.68-.46-1.02-.88-1.79-.03-2.8l26.74-24.7c1.49-2.48.2-4.57,2.2-7.15.77-.99,14.3-9.88,15.27-10.07,3.49-.7,17.18,13.08,19.87,11.63l24.41-34.09c2.92-1.71,17.73,13.57,22.79,13.99,2.43.2,19.02-3.44,20.61-4.72s1.69-4.28,4.16-3.76Z"
        onMouseEnter={() => handleHoverDistrict('kreis2')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis2')}
      />
      <DistrictPath
        district="kreis3"
        path="M682.71,340.86l26.67,32.71,14.97-36.45,12.7,17.2c4.79,4.55,22.34,11.14,25.24,14.98.65.87,1.03,1.63.83,2.75l-6.27,27.1c9.78,13.4,18.01,28.89,27.97,42.04,15.77,20.83,37.82,40.01,55.06,59.94,16.52,4.44,33.45,5.06,50.34,6.23.16,2.33.9,4.56,1.05,6.9.53,8.12,1.83,23.45.92,30.91-.53,4.32-4.09,8.57-5.63,12.59l38.34,7.01c1.35,1.39,8.73,33.85,9.16,37.68.58,5.14-10.61,8.97-15.09,10.65-16.66,6.24-35.33-3.06-52.37-2.61-11.43.3-25.55,5.48-37.31,6.2-2.77,1.24-6.65,21.31-10.08,22.94-.69.33-1.32.51-2.08.27-37.95-11.43-75.25-25.04-114.53-31.42l-36.73-35.26c-12.74-2.39-27.06-1.45-39.67-3.34-1.26-.19-2.28-.62-3.31-1.37-4.29-3.13-11.36-23.24-15.49-28.45l-24.08-15.23c-4.98-2.44-8.5,6.09-13.19,5.85-1.17-.06-19.61-9.8-20.29-10.72-.97-1.31,1.53-12.06,1.51-15.01,0-.79-1.53-1.67-1.29-3.49.66-4.94,14.85-24.88,14.66-28.12l-15.74-42.33c-.26-4.34,10.13-9.08,9.23-12.77-.8-3.31-9.82-11.84-11.56-15.68-.46-1.02-.88-1.79-.03-2.8l26.74-24.7c1.49-2.48.2-4.57,2.2-7.15.77-.99,14.3-9.88,15.27-10.07,3.49-.7,17.18,13.08,19.87,11.63l24.41-34.09c2.92-1.71,17.73,13.57,22.79,13.99,2.43.2,19.02-3.44,20.61-4.72s1.69-4.28,4.16-3.76Z"
        onMouseEnter={() => handleHoverDistrict('kreis3')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis3')}
      />
      <DistrictPath
        className="district"
        district="kreis4"
        path="M682.71,340.86l26.67,32.71,14.97-36.45,12.7,17.2c4.79,4.55,22.34,11.14,25.24,14.98.65.87,1.03,1.63.83,2.75l-6.27,27.1c9.78,13.4,18.01,28.89,27.97,42.04,15.77,20.83,37.82,40.01,55.06,59.94,16.52,4.44,33.45,5.06,50.34,6.23.16,2.33.9,4.56,1.05,6.9.53,8.12,1.83,23.45.92,30.91-.53,4.32-4.09,8.57-5.63,12.59l38.34,7.01c1.35,1.39,8.73,33.85,9.16,37.68.58,5.14-10.61,8.97-15.09,10.65-16.66,6.24-35.33-3.06-52.37-2.61-11.43.3-25.55,5.48-37.31,6.2-2.77,1.24-6.65,21.31-10.08,22.94-.69.33-1.32.51-2.08.27-37.95-11.43-75.25-25.04-114.53-31.42l-36.73-35.26c-12.74-2.39-27.06-1.45-39.67-3.34-1.26-.19-2.28-.62-3.31-1.37-4.29-3.13-11.36-23.24-15.49-28.45l-24.08-15.23c-4.98-2.44-8.5,6.09-13.19,5.85-1.17-.06-19.61-9.8-20.29-10.72-.97-1.31,1.53-12.06,1.51-15.01,0-.79-1.53-1.67-1.29-3.49.66-4.94,14.85-24.88,14.66-28.12l-15.74-42.33c-.26-4.34,10.13-9.08,9.23-12.77-.8-3.31-9.82-11.84-11.56-15.68-.46-1.02-.88-1.79-.03-2.8l26.74-24.7c1.49-2.48.2-4.57,2.2-7.15.77-.99,14.3-9.88,15.27-10.07,3.49-.7,17.18,13.08,19.87,11.63l24.41-34.09c2.92-1.71,17.73,13.57,22.79,13.99,2.43.2,19.02-3.44,20.61-4.72s1.69-4.28,4.16-3.76Z"
        onMouseEnter={() => handleHoverDistrict('kreis4')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis4')}
      />
      <DistrictPath
        district="kreis5"
        path="M682.71,340.86l26.67,32.71,14.97-36.45,12.7,17.2c4.79,4.55,22.34,11.14,25.24,14.98.65.87,1.03,1.63.83,2.75l-6.27,27.1c9.78,13.4,18.01,28.89,27.97,42.04,15.77,20.83,37.82,40.01,55.06,59.94,16.52,4.44,33.45,5.06,50.34,6.23.16,2.33.9,4.56,1.05,6.9.53,8.12,1.83,23.45.92,30.91-.53,4.32-4.09,8.57-5.63,12.59l38.34,7.01c1.35,1.39,8.73,33.85,9.16,37.68.58,5.14-10.61,8.97-15.09,10.65-16.66,6.24-35.33-3.06-52.37-2.61-11.43.3-25.55,5.48-37.31,6.2-2.77,1.24-6.65,21.31-10.08,22.94-.69.33-1.32.51-2.08.27-37.95-11.43-75.25-25.04-114.53-31.42l-36.73-35.26c-12.74-2.39-27.06-1.45-39.67-3.34-1.26-.19-2.28-.62-3.31-1.37-4.29-3.13-11.36-23.24-15.49-28.45l-24.08-15.23c-4.98-2.44-8.5,6.09-13.19,5.85-1.17-.06-19.61-9.8-20.29-10.72-.97-1.31,1.53-12.06,1.51-15.01,0-.79-1.53-1.67-1.29-3.49.66-4.94,14.85-24.88,14.66-28.12l-15.74-42.33c-.26-4.34,10.13-9.08,9.23-12.77-.8-3.31-9.82-11.84-11.56-15.68-.46-1.02-.88-1.79-.03-2.8l26.74-24.7c1.49-2.48.2-4.57,2.2-7.15.77-.99,14.3-9.88,15.27-10.07,3.49-.7,17.18,13.08,19.87,11.63l24.41-34.09c2.92-1.71,17.73,13.57,22.79,13.99,2.43.2,19.02-3.44,20.61-4.72s1.69-4.28,4.16-3.76Z"
        onMouseEnter={() => handleHoverDistrict('kreis5')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis5')}
      />
      <DistrictPath
        district="kreis6"
        path="M682.71,340.86l26.67,32.71,14.97-36.45,12.7,17.2c4.79,4.55,22.34,11.14,25.24,14.98.65.87,1.03,1.63.83,2.75l-6.27,27.1c9.78,13.4,18.01,28.89,27.97,42.04,15.77,20.83,37.82,40.01,55.06,59.94,16.52,4.44,33.45,5.06,50.34,6.23.16,2.33.9,4.56,1.05,6.9.53,8.12,1.83,23.45.92,30.91-.53,4.32-4.09,8.57-5.63,12.59l38.34,7.01c1.35,1.39,8.73,33.85,9.16,37.68.58,5.14-10.61,8.97-15.09,10.65-16.66,6.24-35.33-3.06-52.37-2.61-11.43.3-25.55,5.48-37.31,6.2-2.77,1.24-6.65,21.31-10.08,22.94-.69.33-1.32.51-2.08.27-37.95-11.43-75.25-25.04-114.53-31.42l-36.73-35.26c-12.74-2.39-27.06-1.45-39.67-3.34-1.26-.19-2.28-.62-3.31-1.37-4.29-3.13-11.36-23.24-15.49-28.45l-24.08-15.23c-4.98-2.44-8.5,6.09-13.19,5.85-1.17-.06-19.61-9.8-20.29-10.72-.97-1.31,1.53-12.06,1.51-15.01,0-.79-1.53-1.67-1.29-3.49.66-4.94,14.85-24.88,14.66-28.12l-15.74-42.33c-.26-4.34,10.13-9.08,9.23-12.77-.8-3.31-9.82-11.84-11.56-15.68-.46-1.02-.88-1.79-.03-2.8l26.74-24.7c1.49-2.48.2-4.57,2.2-7.15.77-.99,14.3-9.88,15.27-10.07,3.49-.7,17.18,13.08,19.87,11.63l24.41-34.09c2.92-1.71,17.73,13.57,22.79,13.99,2.43.2,19.02-3.44,20.61-4.72s1.69-4.28,4.16-3.76Z"
        onMouseEnter={() => handleHoverDistrict('kreis6')}
        onMouseLeave={() => handleHoverDistrict(null)}
        onClick={() => handleDistrictClick('kreis6')}
      />
      <DistrictPath
        district="kreis7"
        path="M682.71,340.86l26.67,32.71,14.97-36.45,12.7,17.2c4.79,4.55,22.34,11.14,25.24,14.98.65.87,1.03,1.63.83,2.75l-6.27,27.1c9.78,13.4,18.01,28.89,27.97,42.04,15.77,20.83,37.82,40.01,55.06,59.94,16.52,4.44,33.45,5.06,50.34,6.23.16,2.33.9,4.56,1.05,6.9.53,8.12,1.83,23.45.92,30.91-.53,4.32-4.09,8.57-5.63,12.59l38.34,7.01c1.35,1.39,8.73,33.85,9.16,37.68.58,5.14-10.61,8.97-15.09,10.65-16.66,6.24-35.33-3.06-52.37-2.61-11.43.3-25.55,5.48-37.31,6.2-2.77,1.24-6.65,21.31-10.08,22.94-.69.33-1.32.51-2.08.27-37.95-11.43-75.25-25.04-114.53-31.42l-36.73-35.26c-12.74-2.39-27.06-1.45-39.67-3.34-1.26-.19-2.28-.62-3.31-1.37-4.29-3.13-11.36-23.24-15.49-28.45l-24.08-15.23c-4.98-2.44-8.5,6.09-13.19,5.85-1.17-.06-19.61-9.8-20.29-10.72-.97-1.31,1.53-12.06,1.51-15.01,0-.79-1.53-1.67-1.29-3.49.66-4.94,14.85-24.88,14.66-28.12l-15.74-42.33c-.26-4.34,10.13-9.08,9.23-12.77-.8-3.31-9.82-11.84-11.56-15.68-.46-1.02-.88-1.79-.03-2.8l26.74-24.7c1.49-2.48.2-4.57,2.2-7.15.77-.99,1
